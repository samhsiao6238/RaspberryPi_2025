_å°šæœªæˆåŠŸ_

# æ¨¹è“æ´¾

_[åƒè€ƒ](https://github.com/Huang-junsen/py-xiaozhi)ï¼Œåœ¨æ¨¹è“æ´¾ä¸Šå®‰è£ä¸¦é‹è¡Œå°æ™º AI èŠå¤©åŠ©ç†ï¼Œå¯ä»¥ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿä¾†è¨­ç½®ã€‚_

## æ›´æ–°èˆ‡å®‰è£

1. ç¢ºä¿æ¨¹è“æ´¾ç³»çµ±æ˜¯æœ€æ–°çš„

```bash
sudo apt update && sudo apt upgrade -y
```

2. å®‰è£ä¾è³´ï¼Œå› ç‚º `py-xiaozhi` éœ€è¦éŸ³é »è™•ç†ï¼Œæ‰€ä»¥éœ€è¦å®‰è£ç›¸é—œçš„ FFmpeg å’Œ PortAudio ç­‰å·¥å…·ã€‚

```bash
sudo apt install python3-pyaudio portaudio19-dev ffmpeg libopus0 libopus-dev -y
```

3. ä¸‹è¼‰ py-xiaozhiã€‚

    ```bash
    cd ~/Documents && git clone https://github.com/Huang-junsen/py-xiaozhi.git && cd py-xiaozhi
    ```

4. å®‰è£ä¾è³´

    ```bash
    pip install -r requirements.txt
    ```

## è¨­ç½®

1. æª¢æŸ¥éº¥å…‹é¢¨

```bash
arecord -l
```

2. æª¢æŸ¥å–‡å­

```bash
lsusb
```

3. æ‰‹å‹•æ¸¬è©¦ USB éº¥å…‹é¢¨éŒ„éŸ³ï¼Œä½¿ç”¨çµ„åˆéµ `control+C` åœæ­¢éŒ„éŸ³ã€‚

```bash
arecord -D plughw:3,0 -f cd test.wav
aplay test.wav
```

4. ç·¨è¼¯ ALSA é…ç½®

```bash
sudo nano /etc/asound.conf
```

5. æ·»åŠ ä»¥ä¸‹å…§å®¹

```bash
# è¨­å®šéŒ„éŸ³è¨­å‚™ï¼ˆUSB éº¥å…‹é¢¨ - card 1ï¼‰
pcm.mic_in {
    type plug
    slave.pcm "hw:1,0"
}

ctl.mic_in {
    type hw
    card 1
}

# è¨­å®šæ’­æ”¾è¨­å‚™ï¼ˆUSB å–‡å­ - card 2ï¼‰
pcm.speaker_out {
    type plug
    slave.pcm "hw:2,0"
}

ctl.speaker_out {
    type hw
    card 2
}

# è¨­å®šé è¨­è¨­å‚™
pcm.!default {
    type asym
    playback.pcm "speaker_out"
    capture.pcm "mic_in"
}
```

6. å„²å­˜ä¸¦é‡å•Ÿ ALSA

```bash
sudo alsactl init
```

7. æ¸¬è©¦

```bash
arecord -D mic_in -f cd test.wav
aplay test.wav
```

## CLI æ¨¡å¼

_é©ç”¨æ–¼çµ‚ç«¯æ©Ÿ_

1. æ¨¹è“æ´¾å¯ä½¿ç”¨ CLI æ¨¡å¼

```bash
python main.py --mode cli
```

## GUI æ¨¡å¼

_é©ç”¨æ–¼æ¡Œé¢ç’°å¢ƒï¼Œé‹è¡Œ py-xiaozhiï¼Œå¯ä»¥é¸æ“‡ GUI æ¨¡å¼ æˆ– CLI æ¨¡å¼ ä¾†é‹è¡Œ å°æ™º AI åŠ©ç†ã€‚_

1. é‹è¡Œ

```bash
python main.py
```

2. æ³¨æ„ï¼ŒGUI æ¨¡å¼éœ€è¦ `tkinter`

```bash
sudo apt install python3-tk
```


## æ­¥é©Ÿ 6ï¼šæ¸¬è©¦èˆ‡èª¿æ•´
1. å•Ÿå‹•å¾Œï¼Œæœƒè‡ªå‹•é€£æ¥ å°æ™º AI ä¼ºæœå™¨ï¼ˆwss://api.tenclass.net/xiaozhi/v1/ï¼‰ã€‚
2. æŒ‰ä½æŒ‰éˆ•èªªè©±ï¼ˆGUI æ¨¡å¼ï¼‰æˆ– è¼¸å…¥ CLI æŒ‡ä»¤ï¼ˆCLI æ¨¡å¼ï¼‰ã€‚
3. è‹¥å‡ºç¾éŸ³é‡æ§åˆ¶å•é¡Œï¼Œå¯ä»¥æ‰‹å‹•å®‰è£ ALSAï¼š
   ```bash
   sudo apt install alsa-utils
   ```
4. èª¿æ•´éŸ³é‡ï¼ˆè‹¥ç„¡æ³•æ§åˆ¶éŸ³é‡ï¼‰
   ```bash
   amixer set PCM 90%
   ```



## å¯é¸ï¼šä½¿ç”¨ WebSocket é€£æ¥è‡ªå»ºä¼ºæœå™¨
å¦‚æœä¸æƒ³ä½¿ç”¨å®˜æ–¹ä¼ºæœå™¨ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œéƒ¨ç½² xiaozhi-esp32-serverï¼Œç„¶å¾Œä¿®æ”¹ `main.py` å…§çš„ WebSocket é€£æ¥åœ°å€ã€‚



### ç¸½çµ
âœ… å®‰è£ç³»çµ±ä¾è³´  
âœ… å®‰è£ Python ä¾è³´  
âœ… ä¸‹è¼‰ä¸¦é‹è¡Œ py-xiaozhiï¼ˆæ”¯æ´ GUI & CLI æ¨¡å¼ï¼‰  
âœ… æ¸¬è©¦èªéŸ³äº’å‹•  

é€™æ¨£ä½ çš„ Raspberry Pi å°±èƒ½æˆåŠŸé‹è¡Œ å°æ™º AI èŠå¤©åŠ©ç† äº†ï¼ğŸ‰