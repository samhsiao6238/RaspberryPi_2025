# 登入主控台

_使用 CLI_

<br>

1. 登入

```bash
sudo openhab-cli console
```

2. 帳號預設為 `openhab`，密碼預設為 `habopen`；成功登入後將看到 Karaf Console。

```bash
habopen
```

## 安裝

1. 確認 HTTP Action 是否已安裝

```bash
bundle:list | grep -i http;
```

2. 需要綁定 HTTP 裝置，則安裝 HTTP Binding

```bash
feature:install openhab-binding-http;
```

3. 退出 Karaf Console；不用分號。

```bash
logout
```

## 其他模組

1. openHAB 需要語音支持，可安裝該模組。

```bash
feature:install openhab-core-io-rest-voice;
```

2. 可讓 openHAB 轉換文字為語音並通過揚聲器播放，當某個感測器偵測到特定狀況時，openHAB 語音系統會提醒 _`客廳溫度過高，請檢查空調。`_，並可與 `TTS (Text-to-Speech)` 引擎結合使用，如 `Google TTS` 或 `MaryTTS`。

## 安裝重要模組

_openhab-transport-http 和 openhab-core-io-transport-http_

1. 安裝 openhab-core-io-transport-http

```bash
feature:install openhab-core-io-transport-http;
```

2. 確認已成功安裝

```bash
feature:list | grep openhab-core-io-transport-http;
```

## 設定

1. 編輯設定文件

```bash
sudo nano /etc/openhab/services/addons.cfg
```

2. 檢查或修改 misc 設定，停用 upnp 功能

```bash
misc = none
```

3. 重啟 OpenHAB

```bash
sudo systemctl restart openhab.service
```

4. 進入主控台

```bash
sudo openhab-cli console
```

5. 檢查所有已啟用的 UPnP 模組

```bash
feature:list | grep -i upnp;
```

6. 卸載 UPnP 模組

```bash
feature:uninstall openhab-core-config-discovery-addon-upnp;
feature:uninstall openhab.tp-jupnp;
```

7. 確認哪些 UPnP Bundle 仍在運行

```bash
bundle:list | grep -i upnp;
```

8. 停止所查詢到的 UPnP Bundles

```bash
bundle:stop 267;
bundle:stop 268;
bundle:stop 269;
```

9. 停止後卸載

```bash
bundle:uninstall 267;
bundle:uninstall 268;
bundle:uninstall 269;
```

## 重載

1. 嘗試清除 OpenHAB 的緩存和臨時檔案，然後重新啟動

```bash
sudo systemctl stop openhab.service
sudo rm -rf /var/lib/openhab/cache/*
sudo rm -rf /var/lib/openhab/tmp/*
sudo systemctl start openhab.service
sudo journalctl -u openhab.service -f -n 30
```

2. 確認是否有其他服務或程式占用 UPnP

```bash
sudo netstat -tuln | grep 1900
```




