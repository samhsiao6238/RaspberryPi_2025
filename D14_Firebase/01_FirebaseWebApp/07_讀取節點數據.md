# 讀取節點數據

_讀取溫度數據並繪製動態圖表_

<br>

## 建立網站

_沿用前面步驟建立的網站進行修改_

<br>

1. 在主控台建立 `Web App`。

    ![](images/img_60.png)

<br>

2. 命名暱稱如 `我的監聽圖表網站`。

    ![](images/img_61.png)

<br>

3. 建立文本 `index.html`。

    ```html
    <!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="UTF-8">
    <title>Temperature Chart</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-database.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body>

    <div class="container">
    <h2>Temperature Chart</h2>
    <canvas id="tempChart"></canvas>
    </div>

    <script>
    // 更改為自己的設定，從 Firebase 複製貼上即可
    var firebaseConfig = {
        // 更改為自己的
    };
    // 初始化 Firebase
    firebase.initializeApp(firebaseConfig);
    var database = firebase.database();

    // 初始化 Chart.js
    var ctx = document.getElementById('tempChart').getContext('2d');
    var tempChart = new Chart(ctx, {
        type: 'line',
        data: {
        labels: [],
        datasets: [{
            label: 'Temperature (°C)',
            data: [],
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
        }]
        },
        options: {
        scales: {
            yAxes: [{
            ticks: {
                beginAtZero: true
            }
            }]
        }
        }
    });

    // 監聽 Firebase
    var temperatureRef = firebase.database().ref('raspberrypi/temperature');
    temperatureRef.on('value', function(snapshot) {
        var temperature = snapshot.val().temperature;
        var timestamp = snapshot.val().timestamp;
        // 
        var date = new Date(timestamp * 1000);
        // 
        var label = date.getHours() + ':' + date.getMinutes().toString().padStart(2, '0') + ':' + date.getSeconds().toString().padStart(2, '0');

        // Update chart
        tempChart.data.labels.push(label);
        tempChart.data.datasets.forEach((dataset) => {
            dataset.data.push(temperature);
        });
        tempChart.update();
    });
    </script>

    </body>
    </html>

    ```

<br>

3. 複製 `服務帳戶` 中提供的這段代碼到文本的 `<script></script>` 區塊。

    ![](images/img_62.png)

<br>


___

_END_
