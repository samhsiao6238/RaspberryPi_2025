# Pico W 

_使用 MicroPython + VS Code，連線 Wi-Fi 並發送 LINE 通知_

## 在 VS Code 撰寫與上傳程式碼

1. 建立專案資料夾如 `pico-line-notify`，編輯腳本 `boot.py`，作為 Wi-Fi 初始化。

```python
import network
import time

def connect_wifi(ssid, password):
    wlan = network.WLAN(network.STA_IF)
    wlan.active(True)
    if not wlan.isconnected():
        print('正在連線到 WiFi...')
        wlan.connect(ssid, password)
        timeout = 10
        while not wlan.isconnected() and timeout > 0:
            time.sleep(1)
            timeout -= 1
    return wlan.isconnected()
```

2. 編輯 `main.py`，這是主程式，用來連網後發送 LINE 通知

```python
import urequests
import time
from boot import connect_wifi

# WiFi 設定
SSID = "SamHome2.4g"
PASSWORD = "sam112233"

# LINE Notify 權杖
LINE_TOKEN = "WemrA5mtsqcBcvTEG59tXmVGVTDj8wifXH51GzjWXx8"

def send_line_notify(message):
    url = "https://notify-api.line.me/api/notify"
    headers = {
        "Authorization": f"Bearer {LINE_TOKEN}",
        "Content-Type": "application/x-www-form-urlencoded"
    }
    data = f"message={message}"
    response = urequests.post(url, headers=headers, data=data)
    print("回應碼：", response.status_code)
    response.close()

# 主流程
if connect_wifi(SSID, PASSWORD):
    print("✅ WiFi 已連線")
    send_line_notify("🎉 Pico W 成功上線並發送通知！")
else:
    print("❌ WiFi 連線失敗")
```

## 上傳程式到 Pico W

1. 打開 VS Code → 開啟 `pico-line-notify` 資料夾
2. 確保 Pico W 已接上 USB 且已燒好 MicroPython
3. 點開下方 Pymakr Console
4. 點選「Upload」或在命令列輸入：

```bash
> pymakr upload
```

會將 `boot.py` 和 `main.py` 上傳到 Pico W



## ✅ 第三階段：驗證效果

1. Pico W 通電後會執行 `main.py`
2. 嘗試連上 SSID「SamHome2.4g」密碼「sam112233」
3. 連線成功後，透過 `urequests` 傳送一條 LINE Notify 訊息
4. 你會在 LINE 收到：
   ```
   🎉 Pico W 成功上線並發送通知！
   ```



## 📦 額外提示：安裝 urequests（如果出錯）

若出現找不到 `urequests` 的錯誤，你可以手動上傳 `urequests.py` 到 Pico W。

1. 下載 `urequests.py`：
   https://github.com/micropython/micropython-lib/blob/master/micropython/urequests/urequests.py

2. 將該檔案放進你的專案中，上傳到開發板即可。



如果你想再進一步把這個流程變成自動化腳本、或者結合感測器輸入（如溫濕度警報通知），我也可以幫你擴充 🔧

需要我提供 urequests 檔案或擴充版通知邏輯嗎？