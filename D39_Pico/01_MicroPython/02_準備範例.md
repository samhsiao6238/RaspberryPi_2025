# 基本範例

_在 VS Code 整合 `mpremote` 工具，實現一鍵自動上傳 MicroPython 程式到 Raspberry Pi Pico W_

<br>

## 步驟

1. 安裝必要工具。

<br>

2. 編寫上傳用 `.sh` 腳本或 `.bat` for Windows。

<br>

3. 配置 VS Code 的 `tasks.json`。

<br>

4. 最後直接一鍵執行上傳。

<br>

## 建立專案

1. 建立以下的結構。

    ```bash
    pico-line-notify/
    ├── main.py
    ├── boot.py
    ├── upload.sh
    └── .vscode/
        └── tasks.json
    ```

<br>

2. 建立指令。

```bash
# 建立主資料夾
mkdir -p pico-line-notify/.vscode

# 進入專案資料夾
cd pico-line-notify

# 建立 Python 檔案及上傳腳本
touch main.py boot.py upload.sh

# 賦予執行權限
chmod +x upload.sh

# 建立 VS Code 任務設定檔
touch .vscode/tasks.json
```

3. `upload.sh` 內容如下，for macOS / Linux。

```bash
#!/bin/bash

# 上傳 boot.py 與 main.py 到 Pico W
mpremote connect auto fs cp boot.py :boot.py
mpremote connect auto fs cp main.py :main.py
echo "✅ 上傳完成！"
```

4. macOS/Linux 必須賦予執行權限。

```bash
chmod +x upload.sh
```

5. 如果使用 Windows，改存成 `upload.bat`，內容如下。

```bat
@echo off
mpremote connect auto fs cp boot.py :boot.py
mpremote connect auto fs cp main.py :main.py
echo ✅ 上傳完成！
pause
```

## 配置 `tasks.json`

1. 使用 macOS / Linux 系統，建立 `.vscode/tasks.json`，內容如下。

```json
{
    "version": "2.0.0",
    "tasks": [
        {
        "label": "Upload to Pico W",
        "type": "shell",
        "command": "${workspaceFolder}/upload.sh",
        "group": {
            "kind": "build",
            "isDefault": true
        },
        "problemMatcher": [],
        "detail": "使用 mpremote 自動上傳 MicroPython 程式到 Pico W"
        }
    ]
}
```

2. 使用 Windows 將 `command` 改為以下。

```json
"command": "${workspaceFolder}\\upload.bat",
```

## 一鍵上傳

1. mac 在 VS Code 按下 `Cmd + Shift + P`，Win/Linux 是 `Ctrl + Shift + P`（），然後設定 `keybindings.json`。

```json
// 上傳到 Pico W
{
    "key": "shift+u",
    "command": "workbench.action.tasks.runTask",
    "args": "Upload to Pico W",
    "when": "editorTextFocus"
}
```

2. 快速鍵執行 `Cmd + U`，每次修改 `main.py` 或 `boot.py`，只要執行這個 Task 就能自動上傳到 Pico W


