# å…§å»ºæº«åº¦æ„Ÿæ¸¬å™¨

_å…§å»ºæº«åº¦æ„Ÿæ¸¬å™¨æ˜¯ç”¨ä¾†é‡æ¸¬æ™¶ç‰‡æº«åº¦ï¼Œä¸æ˜¯å‘¨åœç’°å¢ƒæº«åº¦_

## é€£æ¥

1. æ’å…¥ Pico Wï¼Œé€éæŒ‡ä»¤æŸ¥çœ‹åºåˆ—è£ç½®ï¼Œæœƒçœ‹åˆ°é¡ä¼¼ `/dev/tty.usbmodem14201` çš„è£ç½®åç¨±ã€‚

```bash
PORT=$(ls /dev/tty.usbmodem*)
echo $PORT
```

2. ç”¨ `screen` é€£ç·šåˆ° REPLï¼Œå¦‚æœå‡ºç¾ç©ºç™½ç•«é¢ï¼ŒæŒ‰ä¸‹ `Ctrl + D` çœ‹æ˜¯å¦æœ‰ REPL å•Ÿå‹•

```bash
screen $PORT 115200
```

## ä¸Šå‚³è…³æœ¬

1. å»ºè­°ä»»æ„åç¨±å°ˆæ¡ˆã€‚

```bash
mkdir -p ~/Desktop/ex_0330 && cd ~/Desktop/ex_0330
```

2. å»ºç«‹è…³æœ¬ã€‚

```bash
touch main.py
```

3. ç·¨è¼¯ä¸»è…³æœ¬ `main.py`

```python
import machine
import utime

# ADC4 æ˜¯å…§å»ºæº«åº¦æ„Ÿæ¸¬å™¨
sensor_temp = machine.ADC(4)
conversion_factor = 3.3 / (65535)

def read_onboard_temperature():
    reading = sensor_temp.read_u16() * conversion_factor
    temperature_c = 27 - (reading - 0.706) / 0.001721
    return temperature_c

while True:
    temp = read_onboard_temperature()
    print("ğŸŒ¡ï¸ å…§å»ºæº«åº¦ï¼š{:.2f} Â°C".format(temp))
    # æ¯2ç§’è¼¸å‡ºä¸€æ¬¡
    utime.sleep(2)
```

3. ä¸Šå‚³æª”æ¡ˆåˆ° Pico Wï¼Œé€™è£¡ä½¿ç”¨ `mpremote`ï¼Œé‡æ–°å•Ÿå‹•ä¸¦æŸ¥çœ‹è¼¸å‡ºï¼Œå¯æ–·é–‹å†é‡æ’ USBï¼Œæ’ä¸Šå¾Œæœƒè‡ªå‹•åŸ·è¡Œ `main.py`ã€‚

```bash
mpremote connect auto fs cp main.py :main.py
```

4. æŸ¥è©¢ç«¯å£ã€‚

```bash
PORT=$(ls /dev/tty.usbmodem*)
echo $PORT
```

5. å•Ÿå‹•ç›£è¦–ï¼›åœ¨åŸ·è¡Œ screen å‰ï¼Œæš«æ™‚è¨­å®š TERM ç‚ºç°¡å–®å€¼

```bash
TERM=xterm screen $PORT 115200
```

## æ¨™æº–çµæŸ

1. åœ¨ `screen` ä¸­è¦é›¢é–‹ `screen`ã€‚

```bash
Ctrl + A ç„¶å¾ŒæŒ‰ Kï¼Œå†æŒ‰ Y ç¢ºèª
```

## å¼·åˆ¶çµæŸ

2. ç”¨ lsof æŸ¥çœ‹æ˜¯å¦å·²æœ‰å…¶ä»–ç¨‹å¼ä½”ç”¨è©²åºåˆ—åŸ ï¼Œscreen ä¸å…è¨±åŒä¸€æ™‚é–“å¤šå€‹ session ä½¿ç”¨åŒä¸€å€‹åºåˆ—åŸ ã€‚

```bash
lsof | grep tty.usbmodem
```

3. ç”¨ PID kill æ‰ä½”ç”¨çš„ screen

```bash
kill <é€²ç¨‹-ID>
```

4. æˆ–æ˜¯ç”¨ screen æŒ‡ä»¤ç®¡ç† session

```bash
screen -X -S <é€²ç¨‹-ID> kill
```

# çµåˆ MQTT