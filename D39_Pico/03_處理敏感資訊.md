# Pico W 

_ä½¿ç”¨ MicroPython + VS Codeï¼Œé€£ç·š Wi-Fi ä¸¦ç™¼é€ LINE é€šçŸ¥_

<br>

## æ•æ„Ÿè³‡è¨Š

_MicroPython é–‹ç™¼æ¿ä¸æœƒè‡ªå‹•è®€å–é›»è…¦ç«¯çš„æ¨¡çµ„ï¼Œå¿…é ˆæ‰‹å‹•ä¸Šå‚³_

<br>

1. æ·»åŠ è…³æœ¬è™•ç†æ•æ„Ÿè³‡è¨Šã€‚

    ```bash
    touch mysecrets.py .gitignore
    ```

<br>

2. ç·¨è¼¯ `.gitignore`ï¼Œå°‡æ•æ„Ÿè³‡è¨ŠåŠ å…¥ã€‚

    ```bash
    secrets.py
    ```

<br>

3. ç·¨è¼¯ `mysecrets.py` å…§å®¹ã€‚

    ```bash
    # mysecrets.py
    SSID = "<SSID-åç¨±>"
    PASSWORD = "<SSID-å¯†ç¢¼>"
    LINE_TOKEN = "<Line-æ¬Šæ–>"
    ```

<br>

3. ä¿®æ”¹ `upload.sh`ï¼Œæ·»åŠ è…³æœ¬

    ```bash
    #!/bin/bash

    # ä¸Šå‚³ boot.py èˆ‡ main.py åˆ° Pico W
    mpremote connect auto fs cp boot.py :boot.py
    mpremote connect auto fs cp main.py :main.py
    # æ·»åŠ 
    mpremote connect auto fs cp mysecrets.py :mysecrets.py
    echo "âœ… ä¸Šå‚³å®Œæˆï¼"
    ```

<br>

4. ä¿®æ”¹ä¸»è…³æœ¬ `main.py`ã€‚

    ```python
    import urequests
    from boot import connect_wifi
    # å­˜æ”¾æ•æ„Ÿè³‡æ–™çš„æ¨¡çµ„
    import mysecrets

    # WiFi è¨­å®š
    SSID = mysecrets.SSID
    PASSWORD = mysecrets.PASSWORD

    # LINE Notify æ¬Šæ–
    LINE_TOKEN = mysecrets.LINE_TOKEN

    def send_line_notify(message):
        url = "https://notify-api.line.me/api/notify"
        headers = {
            "Authorization": f"Bearer {LINE_TOKEN}",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        data = f"message={message}"
        response = urequests.post(url, headers=headers, data=data)
        print("å›æ‡‰ç¢¼ï¼š", response.status_code)
        response.close()

    # ä¸»æµç¨‹
    if connect_wifi(SSID, PASSWORD):
        print("âœ… WiFi å·²é€£ç·š")
        send_line_notify("ğŸ‰ğŸ‰ Pico W æˆåŠŸä¸Šç·š")
    else:
        print("âŒ WiFi é€£ç·šå¤±æ•—")
    ```

<br>

## åœ¨ VS Code æ’°å¯«èˆ‡ä¸Šå‚³ç¨‹å¼ç¢¼

1. å»ºç«‹å°ˆæ¡ˆè³‡æ–™å¤¾å¦‚ `pico-line-notify`ï¼Œç·¨è¼¯è…³æœ¬ `boot.py`ï¼Œä½œç‚º Wi-Fi åˆå§‹åŒ–ã€‚

    ```python
    import network
    import time

    def connect_wifi(ssid, password):
        wlan = network.WLAN(network.STA_IF)
        wlan.active(True)
        if not wlan.isconnected():
            print('æ­£åœ¨é€£ç·šåˆ° WiFi...')
            wlan.connect(ssid, password)
            timeout = 10
            while not wlan.isconnected() and timeout > 0:
                time.sleep(1)
                timeout -= 1
        return wlan.isconnected()
    ```

<br>

2. ç·¨è¼¯ `main.py`ï¼Œé€™æ˜¯ä¸»ç¨‹å¼ï¼Œç”¨ä¾†é€£ç¶²å¾Œç™¼é€ LINE é€šçŸ¥

    ```python
    import urequests
    from boot import connect_wifi
    # å­˜æ”¾æ•æ„Ÿè³‡æ–™çš„æ¨¡çµ„
    import mysecrets

    # WiFi è¨­å®š
    SSID = mysecrets.SSID
    PASSWORD = mysecrets.PASSWORD

    # LINE Notify æ¬Šæ–
    LINE_TOKEN = mysecrets.LINE_TOKEN

    def send_line_notify(message):
        url = "https://notify-api.line.me/api/notify"
        headers = {
            "Authorization": f"Bearer {LINE_TOKEN}",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        data = f"message={message}"
        response = urequests.post(url, headers=headers, data=data)
        print("å›æ‡‰ç¢¼ï¼š", response.status_code)
        response.close()

    # ä¸»æµç¨‹
    if connect_wifi(SSID, PASSWORD):
        print("âœ… WiFi å·²é€£ç·š")
        send_line_notify("ğŸ‰ğŸ‰ Pico W æˆåŠŸä¸Šç·š")
    else:
        print("âŒ WiFi é€£ç·šå¤±æ•—")
    ```

<br>

3. ä½¿ç”¨çµ„åˆéµä¸Šå‚³ç¨‹å¼åˆ° Pico W

<br>

___

_END_