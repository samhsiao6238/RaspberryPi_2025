# 權限管理指令

_用來控制 Linux 系統中檔案與目錄的 `讀、寫、執行` 權限，以及設定或變更檔案 `擁有者` 與 `群組`。_

<br>

## `sudo`

1. 以 `root` 權限執行指令；`root` 就是 Linux 系統中的最高權限帳戶，擁有對系統所有檔案與指令的完全控制權限。

    ```bash
    # 以 root 權限執行更新
    sudo apt update
    ```

<br>

2. 在系統中執行需要完整管理權限的操作，可運行指令進入 `root shell`，之後所執行的指令都將以 `root` 權限執行，就等同以 `root` 登入。

    ```bash
    sudo -i
    ```

<br>

## `chmod`

_更改檔案權限_

<br>

1. `u+r`：給 `u 用戶` `+ 增加` `r 讀取` 權限。

    ```bash
    chmod u+r file.txt
    ```

<br>

2. `g-w`：對 `g 群組` `- 移除` `w 寫入` 權限。

    ```bash
    chmod g-w file.txt
    ```

<br>

3. `a+x`：給 `a 所有人` `+ 增加` `x 執行` 權限。

    ```bash
    chmod a+x file.txt
    ```

<br>

4. `755`：給 `用戶、群組、其他人` 設定權限為 `讀寫執行 7`、`讀取和執行 5`、`讀取和執行 5`。

    ```bash
    chmod 755 file.txt
    ```

<br>

5. 彙整以上的參數。

    ```bash
    u：用戶 `user`

    g：群組 `group`

    o：其他人 `other`

    a：所有人 `all`

    r：讀取權限 `read`，可列出目錄內容

    w：寫入權限 `write`，可建立/刪除該目錄下的檔案

    x：執行權限 `execute`，可進入該目錄

    +：增加權限

    -：移除權限

    =：設置權限
    ```

<br>

6. 權限對應表中，三個欄位分別代表 `user`、`group`、`others`；每欄位的權限種以 `r = 4`、`w = 2`、`x = 1` 夾總表示；例如 `7=4+2+1`、`5=4+1`。

    ```bash
    chmod 755
    ```

<br>

## `chown`

_注意使用者或群組需存在系統中，否則會失敗_

<br>

1. 更改檔案擁有者，語法結構如下。

    ```bash
    # <帳號>：新文件擁有者的使用者名稱
    # <群組>：新文件群組的名稱
    # <檔案>：要更改擁有者和群組的目標文件或目錄
    chown <帳號>:<群組> <檔案>
    ```

<br>

2. 將 `file.txt` 的擁有者改為 `user1`，群組改為 `group1`。

    ```bash
    chown user1:group1 file.txt
    ```

<br>

3. 將 `file.txt` 的擁有者改為 `user1`，群組保持不變。

    ```bash
    chown user1 file.txt
    ```

<br>

4. 將 `file.txt` 的群組改為 `group1`，擁有者保持不變。

    ```bash
    chown :group1 file.txt
    ```

<br>

5. 遞歸處理指定目錄 `directory` 及其所有子文件和子目錄，將擁有者和群組改為 `user1:group1`。

    ```bash
    chown -R user1:group1 directory/
    ```

<br>

6. 新建檔案並指定擁有者為 user1:group1。

    ```bash
    touch newfile.txt && chown user1:group1 newfile.txt
    ```

<br>

## `chgrp`

1. 修改檔案或目錄的群組。

    ```bash
    chgrp group1 file.txt
    ```

<br>

## `umask`

_控制新檔案或目錄的預設權限；預設新檔案權限為 `666 - umask`、預設新目錄權限為 `777 - umask`。_

<br>

1. 顯示目前的 umask 設定。

    ```bash
    umask
    ```

<br>

2. 修改 umask（只影響當前 shell）。

    ```bash
    umask 0002
    ```

<br>

## `stat`

1. 顯示檔案的詳細資訊，包括權限、link 數、大小與時間等。

    ```bash
    stat file.txt
    ```

<br>

___

_END_